# The Behavior-Bound Digital Twin: Predictive 6G-V2X Authentication via RESTful IMU-PUFs

![Laravel](https://img.shields.io/badge/Laravel-12.x-FF2D20?style=for-the-badge&logo=laravel)
![PHP](https://img.shields.io/badge/PHP-8.4-777BB4?style=for-the-badge&logo=php)
![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)

## Abstract & Research Overview

[cite_start]This repository contains the **RESTful Microservices Implementation** of the **Behavior-Bound Digital Twin (BBDT)** protocol, as presented in our research for **IEEE Access**[cite: 3728].

[cite_start]The transition to Sixth-Generation (6G) Vehicle-to-Everything (V2X) networks demands security architectures that go beyond static cryptographic credentials, which are vulnerable to physical tampering and replay attacks[cite: 3736, 3737]. This research introduces a **Digital Twin Security Broker (DTSB)** hosted at the network edge. [cite_start]Unlike traditional PKI, the DTSB establishes a "behavior-bound identity" by enforcing a closed-loop verification mechanism[cite: 3739]:

1.  [cite_start]**Hardware Verification:** Validates the vehicle's physical integrity using **Inertial Measurement Unit (IMU)-based Physical Unclonable Functions (PUFs)**[cite: 3740].
2.  [cite_start]**Behavioral Verification:** Validates the vehicle's intent by comparing its actual telemetry ($S_{act}$) against a predictive trajectory model ($S_{pred}$) generated by the Digital Twin[cite: 3740].

[cite_start]This framework shifts V2X security from **Static Trust** to **Continuous, Physics-Aware Verification**[cite: 3742].

---

## System Architecture & Methodology

[cite_start]The project implements a three-tier architecture [cite: 3842] orchestrated via Laravel Middleware and Controllers:

### Tier 1: The Physical Layer (Vehicle OBU)

-   [cite_start]**Role:** Generates unique hardware signatures ($R_{puf}$) using IMU sensors (accelerometers and gyroscopes)[cite: 3843].
-   **Implementation:** Simulated via REST Client sending telemetry payloads.

### Tier 2: The Edge Layer (DTSB - _This Repository_)

-   [cite_start]**Role:** Acts as the Security Broker hosted on Multi-access Edge Computing (MEC) nodes[cite: 3845].
-   **Key Components:**
    -   `DtsbAuthController`: Handles the 3-phase handshake (Registration, Challenge, Verification).
    -   [cite_start]`DigitalTwinPredictor`: Service class running the Kalman-like trajectory prediction logic ($S_{pred}$)[cite: 3861].
    -   `BehaviorBoundMiddleware`: Intercepts V2X traffic to enforce Zero Trust principles.

### Tier 3: The Trust Anchor

-   [cite_start]**Role:** Stores immutable logs and trust scores, replacing traditional Certificate Revocation Lists (CRLs)[cite: 3847].
-   [cite_start]**Implementation:** Database Layer (MySQL for logs, Redis for high-speed state caching)[cite: 3892].

---

## Installation & Setup Guide

Since this repository follows standard security practices, vendor files (`/vendor`) and environment secrets (`.env`) are excluded from the repository. Please follow these steps to set up the environment locally.

### Prerequisites

-   **PHP** >= 8.1
-   **Composer**
-   **MySQL** Database

### Step 1: Clone the Repository

```bash
git clone [https://github.com/Jamil226/bbdt-paper.git](https://github.com/Jamil226/bbdt-paper)
cd your-bbdt-paper
```

### Step 2: Install Dependencies

Regenerate the /vendor folder by installing dependencies:

```
composer install
```

### Step 3: Environment Configuration

Create a new .env file from the example file:

```
cp .env.example .env
```

Open the .env file and configure your database credentials:

```
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=v2x_dtsb
DB_USERNAME=your_db_username
DB_PASSWORD=your_db_password
```

### Step 4: Generate Application Key

```
php artisan key:generate
```

### Step 5: Run Database Migrations

Create the necessary tables for PUF Enrollment and Vehicle Twins:

```
php artisan migrate
```

### Step 6: Start the Server

Launch the Laravel development server:

```
php artisan serve
```

The DTSB API will be available at http://127.0.0.1:8000.

## API Endpoints (Protocol Phases)

This implementation exposes the following RESTful endpoints corresponding to the research paper's methodology:

### Phase 1: Registration

-   **Endpoint:** `POST /api/v1/register`
-   **Description:** Enrolls a vehicle's IMU-PUF profile and generates an integrity reference ($REF_i$).

### Phase 2: Predictive Authentication

-   **Endpoint:** `POST /api/v1/auth/challenge`
    -   **Action:** DTSB predicts state ($S_{pred}$) and returns a Context-Aware Nonce ($N_{ctx}$).
-   **Endpoint:** `POST /api/v1/auth/verify`
    -   **Action:** Vehicle submits Hardware Response ($R_{puf}$) and Telemetry ($S_{act}$). DTSB verifies both factors.

### Phase 3: Secure Communication

-   **Endpoint:** `POST /api/v1/v2x/transmit`
    -   **Middleware:** Protected by `BehaviorBoundMiddleware`. Automatically drops packets if trajectory deviation ($\delta$) exceeds the safety threshold.

---

## ðŸ§ª Testing with Postman

A Postman Collection is included in the `/docs` folder of this repository. Import it into Postman to simulate the **Vehicle OBU**.

1.  **Register** a new vehicle to generate the `$REF_i`.
2.  **Request a Challenge** (Note the `nonce_ctx` returned).
3.  **Verify** using the simulated PUF response.
4.  **Transmit** data using the returned Bearer Token (Session Key).

---

## Citation

If you use this code or framework in your research, please cite our work:

```
@article{Jamil202X,

  title={The Behavior-Bound Digital Twin: Predictive 6G-V2X Authentication via RESTful IMU-PUFs},

  author={Muhammad Jamil},

  journal={IEEE Transactions on Consumer Electronics},

  year={2026},

  doi={xxxxxxxxxxxxxxxxxxxxx}

}

```

## Contributing

This is a research prototype. Issues and Pull Requests regarding optimization of the **Trajectory Prediction Algorithm** or **O-RAN Integration** are welcome.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
